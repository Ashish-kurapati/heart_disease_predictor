<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Heart Disease Predictor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
        }
        .result-box {
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }
        .risk {
            background-color: #f8d7da;
            color: #842029;
        }
        .no-risk {
            background-color: #d1e7dd;
            color: #0f5132;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <h2 class="text-center mb-4">Heart Disease Prediction</h2>
    <form action="/predict" method="POST" class="row g-3">

        <div class="col-md-4">
            <label for="age" class="form-label">Age</label>
            <input type="number" class="form-control" name="age" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="sex" class="form-label">Sex (1=Male, 0=Female)</label>
            <input type="number" class="form-control" name="sex" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="cp" class="form-label">Chest Pain Type (0-3)</label>
            <input type="number" class="form-control" name="cp" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="trestbps" class="form-label">Resting Blood Pressure</label>
            <input type="number" class="form-control" name="trestbps" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="chol" class="form-label">Cholesterol</label>
            <input type="number" class="form-control" name="chol" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="fbs" class="form-label">Fasting Blood Sugar (>120 = 1)</label>
            <input type="number" class="form-control" name="fbs" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="restecg" class="form-label">Rest ECG (0-2)</label>
            <input type="number" class="form-control" name="restecg" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="thalach" class="form-label">Max Heart Rate</label>
            <input type="number" class="form-control" name="thalach" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="exang" class="form-label">Exercise Induced Angina (1/0)</label>
            <input type="number" class="form-control" name="exang" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="oldpeak" class="form-label">Oldpeak</label>
            <input type="number" class="form-control" name="oldpeak" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="slope" class="form-label">Slope (0-2)</label>
            <input type="number" class="form-control" name="slope" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="ca" class="form-label">Number of Vessels (0-3)</label>
            <input type="number" class="form-control" name="ca" step="any" required>
        </div>

        <div class="col-md-4">
            <label for="thal" class="form-label">Thalassemia (1=Normal, 2=Fixed Defect, 3=Reversible)</label>
            <input type="number" class="form-control" name="thal" step="any" required>
        </div>

        <div class="col-12 text-center">
            <button type="submit" class="btn btn-danger">Predict</button>
        </div>
    </form>

    {% if prediction %}
        <div class="result-box {{ 'risk' if risk else 'no-risk' }}">
            <h4>{{ prediction }}</h4>
            <p>Prediction Confidence: {{ confidence }}%</p>

            <div style="max-width: 300px; margin: 0 auto;">
                <canvas id="riskChart"></canvas>
            </div>
        </div>
    {% endif %}
</div>

<script>
    {% if prediction %}
        const ctx = document.getElementById('riskChart').getContext('2d');
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Predicted', 'Remaining'],
                datasets: [{
                    label: 'Prediction Confidence',
                    data: [{{ confidence }}, {{ 100 - confidence }}],
                    backgroundColor: [
                        {{ "'#dc3545'" if risk else "'#198754'" }},
                        '#e9ecef'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                plugins: {
                    legend: { display: false }
                }
            }
        });
    {% endif %}
</script>

</body>
</html>
